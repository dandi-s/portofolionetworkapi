<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Network Operations Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üì°</text></svg>">
    <style>
        :root {
            --bg: #f6f7fb;
            --surface: #ffffff;
            --surface-soft: #f9fafe;
            --border: #e6e8f0;
            --text: #101828;
            --muted: #667085;
            --brand: #4f46e5;
            --brand-soft: #eef2ff;
            --info: #0ea5e9;
            --success: #22c55e;
            --warning: #f59e0b;
            --danger: #ef4444;
        }

        body { background: var(--bg); color: var(--text); }

        .card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 16px;
        }

        .fade-in {
            animation: fadeIn 280ms ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(4px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .btn-action {
            border: 1px solid var(--border);
            background: #fff;
            color: var(--text);
            border-radius: 10px;
            padding: 10px 14px;
            font-size: 14px;
            font-weight: 500;
            transition: all 180ms ease;
        }

        .btn-action:hover {
            background: var(--surface-soft);
            border-color: #d5d9e6;
        }

        .btn-primary {
            border: 0;
            background: var(--brand);
            color: #fff;
        }

        .btn-primary:hover {
            background: #4338ca;
        }
    </style>
</head>
<body class="min-h-screen">
    <nav class="sticky top-0 z-40 border-b border-[var(--border)] bg-white/95 backdrop-blur">
        <div class="mx-auto max-w-7xl px-4 py-4">
            <div class="flex flex-wrap items-center justify-between gap-3">
                <div>
                    <h1 class="text-xl md:text-2xl font-semibold tracking-tight">Network Operations Dashboard</h1>
                    <p class="text-sm text-[var(--muted)]">Real-time device management and monitoring</p>
                </div>

                <div class="flex items-center gap-3">
                    <div class="hidden sm:flex items-center gap-2 rounded-full border border-[var(--border)] bg-[var(--surface-soft)] px-3 py-1.5">
                        <span class="h-2 w-2 rounded-full bg-[var(--success)] animate-pulse"></span>
                        <span class="text-xs font-medium text-[var(--muted)]">Live</span>
                    </div>
                    <div class="rounded-full border border-[var(--border)] bg-white px-3 py-1.5 text-xs text-[var(--muted)] min-w-[68px] text-center" id="current-time">--:--</div>
                </div>
            </div>
        </div>
    </nav>

    <main class="mx-auto max-w-7xl px-4 py-6 space-y-6">
        <section class="grid grid-cols-1 gap-4 sm:grid-cols-2 xl:grid-cols-4 fade-in">
            <article class="card p-5">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-xs uppercase tracking-wider text-[var(--muted)]">Total Devices</p>
                        <p id="total-devices" class="mt-2 text-3xl font-semibold">0</p>
                    </div>
                    <div class="rounded-xl bg-[var(--brand-soft)] p-3 text-xl">üñ•Ô∏è</div>
                </div>
                <div class="mt-4 h-1.5 rounded-full bg-[var(--brand-soft)]"></div>
            </article>

            <article class="card p-5">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-xs uppercase tracking-wider text-[var(--muted)]">Online</p>
                        <p id="online-devices" class="mt-2 text-3xl font-semibold text-[var(--success)]">0</p>
                    </div>
                    <div class="rounded-xl bg-green-50 p-3 text-xl">üü¢</div>
                </div>
                <div class="mt-4 h-1.5 rounded-full bg-green-100"></div>
            </article>

            <article class="card p-5">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-xs uppercase tracking-wider text-[var(--muted)]">Offline</p>
                        <p id="offline-devices" class="mt-2 text-3xl font-semibold text-[var(--danger)]">0</p>
                    </div>
                    <div class="rounded-xl bg-red-50 p-3 text-xl">üî¥</div>
                </div>
                <div class="mt-4 h-1.5 rounded-full bg-red-100"></div>
            </article>

            <article class="card p-5">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-xs uppercase tracking-wider text-[var(--muted)]">Commands</p>
                        <p id="active-commands" class="mt-2 text-3xl font-semibold text-[var(--brand)]">0</p>
                    </div>
                    <div class="rounded-xl bg-[var(--brand-soft)] p-3 text-xl">‚öôÔ∏è</div>
                </div>
                <div class="mt-4 h-1.5 rounded-full bg-[var(--brand-soft)]"></div>
            </article>
        </section>

        <section class="card p-4 fade-in">
            <div class="flex flex-wrap items-center gap-2">
                <button id="open-add-device-btn" onclick="showAddDeviceModal()" class="btn-action btn-primary">Add Device</button>
                <div id="selection-actions" class="relative hidden">
                    <button id="selection-menu-toggle" type="button" class="btn-action px-3" title="Selected actions" aria-label="Selected actions">‚ãØ</button>
                    <div id="selection-menu" class="hidden absolute left-0 top-12 w-36 rounded-xl border border-[var(--border)] bg-white p-1 shadow-sm">
                        <button id="open-bulk-edit-btn" onclick="showEditDeviceModal()" class="flex h-10 w-full items-center gap-2 rounded-lg px-3 text-sm text-[var(--text)] hover:bg-[var(--surface-soft)]" title="Edit selected" aria-label="Edit selected">
                            <i class="far fa-edit" aria-hidden="true"></i>
                            <span>Edit</span>
                        </button>
                        <button id="bulk-delete-btn" onclick="deleteSelectedDevices()" class="mt-1 flex h-10 w-full items-center gap-2 rounded-lg px-3 text-sm text-red-600 hover:bg-red-50" title="Delete selected" aria-label="Delete selected">
                            <i class="fas fa-trash-alt" aria-hidden="true"></i>
                            <span>Delete</span>
                        </button>
                    </div>
                </div>
                <button onclick="bulkAction('change_dns')" class="btn-action">Change DNS</button>
                <button onclick="bulkAction('backup')" class="btn-action">Backup Config</button>
                <button onclick="refreshDevices()" class="btn-action">Refresh</button>
                <div class="ml-auto flex flex-wrap items-center gap-2">
                    <input
                        id="search-input"
                        type="search"
                        placeholder="Search device, IP, location..."
                        class="w-64 rounded-lg border border-[var(--border)] bg-white px-3 py-2.5 text-sm outline-none focus:border-[var(--brand)] focus:shadow-[0_0_0_3px_rgba(79,70,229,0.12)]"
                    >
                    <select
                        id="status-filter"
                        class="rounded-lg border border-[var(--border)] bg-white px-3 py-2.5 text-sm outline-none focus:border-[var(--brand)] focus:shadow-[0_0_0_3px_rgba(79,70,229,0.12)]"
                    >
                        <option value="all">All Status</option>
                        <option value="online">Online</option>
                        <option value="offline">Offline</option>
                    </select>
                    <div class="rounded-lg border border-[var(--border)] bg-[var(--surface-soft)] px-3 py-2.5 text-sm text-[var(--muted)]">
                        Selected: <span id="selected-count" class="font-semibold text-[var(--text)]">0</span>
                    </div>
                </div>
            </div>
        </section>

        <section class="card overflow-hidden fade-in">
            <div class="border-b border-[var(--border)] px-5 py-4">
                <h2 class="text-xl font-semibold">Device List</h2>
                <p class="text-sm text-[var(--muted)] mt-1">Manage and monitor all network devices</p>
            </div>
            <div class="overflow-x-auto">
                <table class="w-full">
                    <thead class="bg-[var(--surface-soft)]">
                        <tr>
                            <th class="px-4 py-3 text-left text-xs font-semibold uppercase tracking-wider text-[var(--muted)]">
                                <input id="select-all-devices" type="checkbox" class="h-4 w-4 rounded border-gray-300">
                            </th>
                            <th class="px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider text-[var(--muted)]">Device</th>
                            <th class="px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider text-[var(--muted)]">IP Address</th>
                            <th class="px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider text-[var(--muted)]">Location</th>
                            <th class="px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider text-[var(--muted)]">Status</th>
                            <th class="px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider text-[var(--muted)]">Last Seen</th>
                            <th class="px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider text-[var(--muted)]">Last Downtime</th>
                            <th class="px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider text-[var(--muted)]">Last Modified</th>
                            <th class="px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider text-[var(--muted)]">Created</th>
                        </tr>
                    </thead>
                    <tbody id="devices-table" class="divide-y divide-[var(--border)]">
                        <tr>
                            <td colspan="9" class="px-6 py-12 text-center">
                                <div class="text-4xl mb-2">üì°</div>
                                <p class="font-medium text-[var(--text)]">No devices found</p>
                                <p class="text-sm text-[var(--muted)] mt-1">Click "Add Device" to get started</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="flex flex-wrap items-center justify-between gap-2 border-t border-[var(--border)] px-5 py-3">
                <p id="pagination-info" class="text-sm text-[var(--muted)]">Showing 0 to 0 of 0 devices</p>
                <div class="flex items-center gap-2">
                    <button id="prev-page-btn" onclick="goToPreviousPage()" class="btn-action px-3 py-2 text-sm">Previous</button>
                    <span id="page-indicator" class="text-sm text-[var(--muted)]">Page 1 of 1</span>
                    <button id="next-page-btn" onclick="goToNextPage()" class="btn-action px-3 py-2 text-sm">Next</button>
                </div>
            </div>
        </section>

        <section id="execution-panel" class="hidden card p-5 fade-in">
            <h3 class="text-lg font-semibold">Bulk Operation Progress</h3>
            <div class="mt-4">
                <div class="mb-2 flex items-center justify-between text-sm">
                    <span id="progress-text" class="text-[var(--muted)]">Processing...</span>
                    <span id="progress-percent" class="font-semibold text-[var(--brand)]">0%</span>
                </div>
                <div class="h-2.5 w-full rounded-full bg-[var(--brand-soft)]">
                    <div id="progress-bar" class="h-2.5 rounded-full bg-[var(--brand)] transition-all duration-500" style="width: 0%"></div>
                </div>
            </div>
            <div class="mt-4 grid grid-cols-2 gap-4">
                <div class="rounded-xl border border-green-200 bg-green-50 p-4">
                    <p class="text-xs uppercase tracking-wide text-green-700">Completed</p>
                    <p class="mt-1 text-2xl font-semibold text-green-700" id="completed-count">0</p>
                </div>
                <div class="rounded-xl border border-red-200 bg-red-50 p-4">
                    <p class="text-xs uppercase tracking-wide text-red-700">Failed</p>
                    <p class="mt-1 text-2xl font-semibold text-red-700" id="failed-count">0</p>
                </div>
            </div>
        </section>
    </main>

    <footer class="py-6 text-center text-sm text-[var(--muted)]">
        <p>Network Operations Dashboard ‚Ä¢ Built by <a href="https://github.com/dandi-s" class="font-medium text-[var(--brand)] hover:underline" target="_blank">Dandi Sugiarto</a></p>
    </footer>

    <div id="add-device-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4 backdrop-blur-sm">
        <div class="card w-full max-w-md p-6 fade-in">
            <h3 class="text-xl font-semibold">Add New Device</h3>
            <form id="add-device-form" class="mt-5 space-y-4">
                <div class="grid grid-cols-1 gap-3 sm:grid-cols-2">
                    <div class="sm:col-span-2">
                        <label class="mb-1.5 block text-sm font-medium text-[var(--text)]">Device Name</label>
                        <input type="text" id="device-name" class="w-full rounded-lg border border-[var(--border)] bg-white px-3 py-2.5 text-sm outline-none ring-0 focus:border-[var(--brand)] focus:shadow-[0_0_0_3px_rgba(79,70,229,0.12)]" placeholder="Router-BDG-01" required>
                    </div>
                    <div>
                        <label class="mb-1.5 block text-sm font-medium text-[var(--text)]">IP Address</label>
                        <input type="text" id="device-ip" class="w-full rounded-lg border border-[var(--border)] bg-white px-3 py-2.5 text-sm outline-none ring-0 focus:border-[var(--brand)] focus:shadow-[0_0_0_3px_rgba(79,70,229,0.12)]" placeholder="192.168.100.1" required>
                    </div>
                    <div>
                        <label class="mb-1.5 block text-sm font-medium text-[var(--text)]">Location</label>
                        <input type="text" id="device-location" class="w-full rounded-lg border border-[var(--border)] bg-white px-3 py-2.5 text-sm outline-none ring-0 focus:border-[var(--brand)] focus:shadow-[0_0_0_3px_rgba(79,70,229,0.12)]" placeholder="Jakarta" required>
                    </div>
                    <div>
                        <label class="mb-1.5 block text-sm font-medium text-[var(--text)]">Status</label>
                        <select id="device-status" class="w-full rounded-lg border border-[var(--border)] bg-white px-3 py-2.5 text-sm outline-none ring-0 focus:border-[var(--brand)] focus:shadow-[0_0_0_3px_rgba(79,70,229,0.12)]">
                            <option value="online" selected>Online</option>
                            <option value="offline">Offline</option>
                        </select>
                    </div>
                    <div>
                        <label class="mb-1.5 block text-sm font-medium text-[var(--text)]">Last Seen</label>
                        <input type="datetime-local" id="device-last-seen" class="w-full rounded-lg border border-[var(--border)] bg-white px-3 py-2.5 text-sm outline-none ring-0 focus:border-[var(--brand)] focus:shadow-[0_0_0_3px_rgba(79,70,229,0.12)]">
                    </div>
                    <div>
                        <label class="mb-1.5 block text-sm font-medium text-[var(--text)]">Last Modified</label>
                        <input type="datetime-local" id="device-updated-at" class="w-full rounded-lg border border-[var(--border)] bg-white px-3 py-2.5 text-sm outline-none ring-0 focus:border-[var(--brand)] focus:shadow-[0_0_0_3px_rgba(79,70,229,0.12)]">
                    </div>
                    <div>
                        <label class="mb-1.5 block text-sm font-medium text-[var(--text)]">Created</label>
                        <input type="datetime-local" id="device-created-at" class="w-full rounded-lg border border-[var(--border)] bg-white px-3 py-2.5 text-sm outline-none ring-0 focus:border-[var(--brand)] focus:shadow-[0_0_0_3px_rgba(79,70,229,0.12)]">
                    </div>
                </div>
                <div class="flex gap-3 pt-2">
                    <button type="submit" class="flex-1 rounded-lg bg-[var(--brand)] py-2.5 text-sm font-medium text-white hover:opacity-95 transition">Add Device</button>
                    <button type="button" onclick="hideAddDeviceModal()" class="flex-1 rounded-lg border border-[var(--border)] bg-white py-2.5 text-sm font-medium text-[var(--muted)] hover:bg-[var(--surface-soft)] transition">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <div id="edit-device-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4 backdrop-blur-sm">
        <div class="card w-full max-w-2xl p-6 fade-in">
            <h3 class="text-xl font-semibold">Edit Selected Device</h3>
            <p class="mt-1 text-sm text-[var(--muted)]">Update device details. Select exactly one device to edit.</p>
            <form id="edit-device-form" class="mt-5 space-y-4">
                <div class="grid grid-cols-1 gap-3 sm:grid-cols-2">
                    <div class="sm:col-span-2">
                        <label class="mb-1.5 block text-sm font-medium text-[var(--text)]">Device Name</label>
                        <input type="text" id="edit-device-name" class="w-full rounded-lg border border-[var(--border)] bg-white px-3 py-2.5 text-sm outline-none ring-0 focus:border-[var(--brand)] focus:shadow-[0_0_0_3px_rgba(79,70,229,0.12)]" required>
                    </div>
                    <div>
                        <label class="mb-1.5 block text-sm font-medium text-[var(--text)]">IP Address</label>
                        <input type="text" id="edit-device-ip" class="w-full rounded-lg border border-[var(--border)] bg-white px-3 py-2.5 text-sm outline-none ring-0 focus:border-[var(--brand)] focus:shadow-[0_0_0_3px_rgba(79,70,229,0.12)]" required>
                    </div>
                    <div>
                        <label class="mb-1.5 block text-sm font-medium text-[var(--text)]">Location</label>
                        <input type="text" id="edit-device-location" class="w-full rounded-lg border border-[var(--border)] bg-white px-3 py-2.5 text-sm outline-none ring-0 focus:border-[var(--brand)] focus:shadow-[0_0_0_3px_rgba(79,70,229,0.12)]" required>
                    </div>
                    <div>
                        <label class="mb-1.5 block text-sm font-medium text-[var(--text)]">Status</label>
                        <select id="edit-device-status" class="w-full rounded-lg border border-[var(--border)] bg-white px-3 py-2.5 text-sm outline-none ring-0 focus:border-[var(--brand)] focus:shadow-[0_0_0_3px_rgba(79,70,229,0.12)]">
                            <option value="online">Online</option>
                            <option value="offline">Offline</option>
                        </select>
                    </div>
                    <div>
                        <label class="mb-1.5 block text-sm font-medium text-[var(--text)]">Last Seen</label>
                        <input type="datetime-local" id="edit-device-last-seen" class="w-full rounded-lg border border-[var(--border)] bg-white px-3 py-2.5 text-sm outline-none ring-0 focus:border-[var(--brand)] focus:shadow-[0_0_0_3px_rgba(79,70,229,0.12)]">
                    </div>
                    <div>
                        <label class="mb-1.5 block text-sm font-medium text-[var(--text)]">Last Downtime</label>
                        <input type="datetime-local" id="edit-device-last-downtime" class="w-full rounded-lg border border-[var(--border)] bg-white px-3 py-2.5 text-sm outline-none ring-0 focus:border-[var(--brand)] focus:shadow-[0_0_0_3px_rgba(79,70,229,0.12)]">
                    </div>
                    <div>
                        <label class="mb-1.5 block text-sm font-medium text-[var(--text)]">Last Modified</label>
                        <input type="datetime-local" id="edit-device-updated-at" class="w-full rounded-lg border border-[var(--border)] bg-white px-3 py-2.5 text-sm outline-none ring-0 focus:border-[var(--brand)] focus:shadow-[0_0_0_3px_rgba(79,70,229,0.12)]">
                    </div>
                    <div>
                        <label class="mb-1.5 block text-sm font-medium text-[var(--text)]">Created</label>
                        <input type="datetime-local" id="edit-device-created-at" class="w-full rounded-lg border border-[var(--border)] bg-white px-3 py-2.5 text-sm outline-none ring-0 focus:border-[var(--brand)] focus:shadow-[0_0_0_3px_rgba(79,70,229,0.12)]">
                    </div>
                </div>
                <div class="flex gap-3 pt-2">
                    <button type="submit" class="flex-1 rounded-lg bg-[var(--brand)] py-2.5 text-sm font-medium text-white hover:opacity-95 transition">Save Changes</button>
                    <button type="button" onclick="hideEditDeviceModal()" class="flex-1 rounded-lg border border-[var(--border)] bg-white py-2.5 text-sm font-medium text-[var(--muted)] hover:bg-[var(--surface-soft)] transition">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <div id="bulk-edit-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4 backdrop-blur-sm">
        <div class="card w-full max-w-md p-6 fade-in">
            <h3 class="text-xl font-semibold">Edit Selected Devices</h3>
            <p class="mt-1 text-sm text-[var(--muted)]">Bulk update for multiple selected devices.</p>
            <form id="bulk-edit-form" class="mt-5 space-y-4">
                <div>
                    <label class="mb-1.5 block text-sm font-medium text-[var(--text)]">Status</label>
                    <select id="bulk-edit-status" class="w-full rounded-lg border border-[var(--border)] bg-white px-3 py-2.5 text-sm outline-none focus:border-[var(--brand)]">
                        <option value="keep" selected>Keep existing</option>
                        <option value="online">Online</option>
                        <option value="offline">Offline</option>
                    </select>
                </div>
                <div>
                    <label class="mb-1.5 block text-sm font-medium text-[var(--text)]">Location</label>
                    <input type="text" id="bulk-edit-location" class="w-full rounded-lg border border-[var(--border)] bg-white px-3 py-2.5 text-sm outline-none focus:border-[var(--brand)]" placeholder="Leave empty to keep existing">
                </div>
                <div class="flex gap-3 pt-2">
                    <button type="submit" class="flex-1 rounded-lg bg-[var(--brand)] py-2.5 text-sm font-medium text-white hover:opacity-95 transition">Apply Changes</button>
                    <button type="button" onclick="hideBulkEditModal()" class="flex-1 rounded-lg border border-[var(--border)] bg-white py-2.5 text-sm font-medium text-[var(--muted)] hover:bg-[var(--surface-soft)] transition">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>
